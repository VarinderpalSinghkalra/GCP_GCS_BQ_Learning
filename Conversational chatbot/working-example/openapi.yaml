openapi: 3.0.0

info:
  title: Issue Management API
  version: "1.0.0"
  description: >
    Tool for creating support issues.
    Backed by a Cloud Function (Gen2) with Firestore persistence
    and Gemini-generated acknowledgements.
    Always returns HTTP 200 with a structured JSON response.

servers:
  - url: https://submit-issue-277069041958.us-central1.run.app

paths:
  /:
    post:
      summary: Create a support issue
      operationId: createIssue
      description: >
        Creates a new support issue, stores it in Firestore,
        computes SLA based on priority, and returns an assistant
        acknowledgement generated by Gemini.

      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - reporter_id
                - issue
              properties:
                reporter_id:
                  type: string
                  description: Unique identifier of the reporting user
                  example: deployment-test
                issue:
                  type: string
                  minLength: 5
                  description: Description of the reported issue
                  example: Cloud Run deployment verification
                priority:
                  type: string
                  enum: [P1, P2, P3, P4]
                  default: P3
                  description: Issue priority (defaults to P3 if invalid or missing)

      responses:
        "200":
          description: Tool response (success or validation failure)
          content:
            application/json:
              schema:
                type: object
                required:
                  - issue_id
                  - status
                  - assistant_reply
                properties:
                  issue_id:
                    type: string
                    description: Generated issue identifier or N/A on validation failure
                    example: INC-2303565C
                  status:
                    type: string
                    description: created | failed
                    example: created
                  assistant_reply:
                    type: string
                    description: Assistant acknowledgement or error-safe message
                    example: Your issue has been logged. Our team will follow up.
